<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.01 (Macintosh; I; 68K) [Netscape]">
</HEAD>
<BODY>
<FONT COLOR="#FF0000"><FONT SIZE=+3>DRAFT</FONT></FONT>&nbsp;
<HR width="100%">

<P><IMG SRC="manip.GIF" HEIGHT=32 WIDTH=32><FONT SIZE=+4> Calibration Manipulator
Software</FONT>&nbsp;
<HR size=4 width="100%">

<P><B><FONT SIZE=+2>Umbilical Lookup Tables</FONT></B>

<P>The umbilical is not treated as massless like the control ropes, so
the exact shape of the umbilical must be known in order to drive it properly.
The umbilical hangs in the shape of a catenary, which can have significant
curvature in air but much less curvature when submerged in heavy water.
The catenary equation is a transcendental function with complex boundary
conditions (the model even allows for driving the manipulator during a
partial fill), so these computations are too time-consuming to perform
in real time. For this reason, the umbilical characteristics are pre-calculated
and stored in lookup tables which are accessed while the manipulator is
running.

<P>
<HR SIZE=4 WIDTH="100%">

<P><A NAME="FileGeneration"></A><B><FONT COLOR="#800000"><FONT SIZE=+1>Generating
a Set of Lookup Tables</FONT></FONT></B>
<BR>
<BR>The lookup tables are dependent on the neck ring geometry, the umbilical
feedthrough location, and the umbilical weight in air and buoyancy in water.
If any of these parameters changes, the umbilical lookup tables must be
recalculated. This means that there must be different lookup tables for
umbilicals of different diameter or density, and for umbilicals used in
heavy or light water.&nbsp; There are 3 steps to calculating a set of lookup
tables to be used with the manipulator software:

<P><B>Step 1) Run the CATENARY program</B> to generate an unsorted set
of tables for a range of water levels and positions.

<P>The CATENARY program prompts you for a series of inputs to specify the
output file and geometry parameters for the calculations. All inputs have
a default which is indicated in square brackets. If no value is entered,
the default value will be used.
<BR>
<BR>Here is a sample run of the CATENARY program:
<UL>
<TABLE BORDER >
<TR>
<TD>Output file name [CATENARY.DAT]:&nbsp;

<P>Umbilical linear density in water (N/cm) [0.00064]:&nbsp;

<P>Umbilical linear density in air (N/cm) [0.0148]:&nbsp;

<P>Geometry - 1) SNO or 2) Prototype [1]:&nbsp;
<BR>Neck ring elevation (cm) [580.685]:&nbsp;
<BR>Neck ring radius (cm) [45.582]:&nbsp;
<BR>Umbilical feedthrough elevation (cm) [1450]:&nbsp;

<P>Source position region - 1) Vessel or 2) Neck [1]:&nbsp;
<BR>Range of horizontal source positions (cm) [0,620]:&nbsp;
<BR>Range of vertical source positions (cm) [-620,620]:&nbsp;
<BR>Grid spacing for source positions (cm) [10]:&nbsp;

<P>Water level region - 1) Vessel or 2) Neck [1]:&nbsp;
<BR>Range of water levels (cm) [-620,620]:&nbsp;
<BR>Spacing for water levels (cm) [10]:&nbsp;

<P>Creating new output file&nbsp;
<BR>File size will be 30.04 MB&nbsp;

<P>Press RTN to begin calculations&nbsp;
<BR></TD>
</TR>
</TABLE>
</UL>
<B>Step 2) Run the PARSER program</B> to organize the CATENARY output
into separate files for each water level, and to create a common index
file for the manipulator software.

<P>Here is a sample run of the PARSER program
<UL>
<TABLE BORDER >
<TR>
<TD>--- Catenary lookup table parser ---&nbsp;

<P>Input file name [CATENARY.DAT]:&nbsp;

<P>Umbilical linear density in water: 0.000640&nbsp;
<BR>Umbilical linear density in air: 0.014800&nbsp;
<BR>Acrylic vessel neck ring height: 580.684998&nbsp;
<BR>Acrylic vessel neck ring radius: 45.582001&nbsp;
<BR>Umbilical feedthrough elevation: 1450.000000&nbsp;
<BR>X (0,620,10) Y (-620,620,10) Level (-620,620,10)&nbsp;

<P>Umbilical code letter: A&nbsp;

<P>Created new index file A_INDEX.DAT&nbsp;
<BR>Format for data file names A1_%.0f.DAT&nbsp;
<BR>Open 125 outputs (A1_-620.DAT to A1_620.DAT)&nbsp;
<BR>Last entry: 620 620 620&nbsp;

<P>1) x=0+10 (63) y=-620+10 (125) level=-620+10 (125) A1_%.0f.DAT in vessel&nbsp;

<P>done.&nbsp;
<BR></TD>
</TR>
</TABLE>
</UL>
<B>Step 3) Repeat steps 1) and 2) for water levels and positions in the
neck and vessel</B>.

<P>Either erase CATENARY.DAT after running PARSER, or generate a new output
file for each group of tables by specifying something other than 'CATENARY.DAT'
when running CATENARY and PARSER for subsequent sets of lookup tables.

<P>The final index file generated by PARSER should contain three lookups
for umbilicals that will be used during
<BR>a partial fill:
<UL>
<TABLE BORDER >
<TR>
<TD></TD>

<TD><B>Source in</B></TD>

<TD><B>Water levels in</B></TD>
</TR>

<TR>
<TD><B>1)</B></TD>

<TD>Vessel</TD>

<TD>Vessel</TD>
</TR>

<TR>
<TD><B>2)</B></TD>

<TD>Vessel</TD>

<TD>Neck</TD>
</TR>

<TR>
<TD><B>3)</B></TD>

<TD>Neck</TD>

<TD>Neck</TD>
</TR>
</TABLE>
</UL>
Note that no lookup table is necessary for the case where the source is
in the neck and the water level is in the vessel. In the absence of any
table, the table entry with the closest water level at the given source
position will be used. For this case, a water level at the bottom of the
neck would be assumed. This is functionally equivalent to a water level
in the vessel because in neither case does the umbilical contact the water.

<P>For a steady state case where the water level will be in the neck, only
two lookup tables need to be calculated, and the range of water levels
can be greatly reduced. Probably two water levels 10cm apart bracketing
the expected water level would be sufficient.

<P>Once a complete set of tables is generated, the umbilical entry in the
AXIS.DAT file should be updated so the manipulator software will use the
new tables. This is done by specifying the name of the index file in AXIS.DAT.
See the documentation on <A HREF="manip_dat.html#AXIS.DAT">AXIS.DAT</A>
for more information. For example:
<UL>INDEX_FILE: C:\MANIP\LOOKUPS\A_INDEX.DAT
<BR>&nbsp;</UL>

<HR SIZE=4 WIDTH="100%">

<P><A NAME="FileStructure"></A><B><FONT COLOR="#800000"><FONT SIZE=+1>File
Structure</FONT></FONT></B>

<P>The CATENARY program creates one binary output file which contains a
LookupRange structure followed by a 3-dimensional array of SourceInfo structures
which are organized by water level, Y position and finally X position:
<UL>struct LookupRange {
<UL>float minX, maxX, incrX;
<BR>float minY, maxY, incrY;
<BR>float minLevel, maxLevel, incrLevel;</UL>
};

<P>struct SourceInfo {
<UL>float x,y,level;
<BR>float length; // length of umbilical (cm)
<BR>float driveTension; // tension at umbilical drive (N)
<BR>float horizTension; // horizontal tension at source (N, always +ve)
<BR>float vertTension; // vertical tension at source (N, up is +ve)
<BR>float rubForce; // force on rub ring (N)</UL>
};</UL>
The PARSER program sorts this single binary file into a series of tables,
one for each water level. It also adds the information for this set of
tables to an index file. The index file is binary and contains one LookupInfo
structure for each set of tables. The individual lookup files are 2-dimensional
X,Y arrays of SourceStats structures, arranged with Y varying more quickly.
<UL>struct LookupInfo {
<UL>float x,y; // source position for first calculated point
<BR>float dx,dy; // distance between calculated points
<BR>float level, dlevel; // initial water level, and water level increment
<BR>short nx,ny; // number of calculated points in x and y
<BR>short nlevel; // number of water levels (one per file)
<BR>short inNeck; // non-zero if source is in neck
<BR>char nameFormat[16]; // file name formats for these tables</UL>
};

<P>struct SourceStats {
<UL>float length; // length of umbilical (cm)
<BR>float driveTension; // tension at umbilical drive (N)
<BR>float horizTension; // horizontal tension at source (N)
<BR>float vertTension; // vertical tension at source (N, up is +ve)
<BR>float rubForce; // force on rub ring (N)</UL>
};</UL>
&nbsp;
<HR SIZE=4 WIDTH="100%">

<P><A NAME="CalculationMethods"></A><B><FONT COLOR="#800000"><FONT SIZE=+1>Calculation
Methods</FONT></FONT></B>

<P>The basic catenary equation is
<UL>y = y0 + h/w * cosh( w/h * (x-x0) ) ,</UL>
where
<UL>y = height of umbilical
<BR>x = offset of umbilical from center of detector
<BR>y0 = height of umbilical at minimum point
<BR>x0 = position of minimum point in umbilical
<BR>h = horizontal tension in Newtons
<BR>w = linear weight of umbilical in Newtons/cm</UL>
For an arbitrary source position and water level, we only know the coordinates
of the endpoints of the umbilical. To calculate the shape, we must iterate
to determine the ideal tension, and solve systems of coupled equations
to determine the locations where the umbilical crosses the air/water interface.
In general, the strategy is to run the umbilical so the tension at the
source is a minimum. However, because of the effect of the buoyancy of
the umbilical, in the presence of water the solution for this minimum case
tends to yeild umbilical curves that droop low enough to hit the acrylic
vessel at the bottom. For this reason, an additional constraint is placed
on the solution: The angle of the umbilical at the source is not allowed
to drop below the angle for the minimum tension solution in air.

<P>In reality we want some finite but small tension on the umbilical at
the source. Currently the CATENARY program uses 2 Newtons as the minimum
umbilical tension at the source.

<P>For water levels below the source, there is a possibility of the umbilical
crossing two air/water interfaces. The solution is obtained by solving
nested iterative solutions and requiring continuity of slope across the
interfaces.

<P>The solution is calculated once ignoring the possibility of an intersection
with the acrylic vessel neck ring. If the free-hanging umbilical would
contact the neck ring, the endpoints are changed and the solution is recalculated
as above for each of two umbilical segments, one below the neck ring and
one above. The tension in the umbilical is assumed to be constant across
the neck ring (although the slope may be discontinuous).

<P>The software is complicated because some of the iterative solutions
are not necessarily unique, and can be very unstable in certain areas.
Usually these problems occur in regions of low umbilical tension, so the
minimum umbilical tension is constrained at times to prevent oscillations
in the solution.

<P>The results are ouput as a grid of umbilical characteristics calculated
for various water levels and source positions.

<P>
<HR WIDTH="100%">
</BODY>
</HTML>
